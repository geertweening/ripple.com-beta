var ledgerValidationModule={};ledgerValidationModule.LINE_HEIGHT=19;ledgerValidationModule.lastDisplayedLedgerIndex;ledgerValidationModule.eventQueue={};ledgerValidationModule.handleNewEvent=function(e){var t=e.ledger_index;ledgerValidationModule.lastDisplayedLedgerIndex||(ledgerValidationModule.lastDisplayedLedgerIndex=t);ledgerValidationModule.eventQueue[t]?ledgerValidationModule.eventQueue[t].push(e):ledgerValidationModule.eventQueue[t]=[e]};String.prototype.insert=function(e,t){return e>0?this.substring(0,e)+t+this.substring(e,this.length):t+this};ledgerValidationModule.indicate=function(e,t,n,r){var i=e;io=t.indexOf(n,e);if(io===e){e+=n.length+1;var s=t.indexOf('"',e);if(s-e>3)return[i,t];e=s;e++;var o='<span class="'+r+'">';t=t.insert(e,o);e+=o.length;e=t.indexOf('"',e);o="</span>";t=t.insert(e,o);e+=o.length}return[e,t]};ledgerValidationModule.addSpecialColors=function(e){var t=0;for(;;){if(t>=e.length)break;var n=ledgerValidationModule.indicate(t,e,'"Account"',"b");t=n[0];e=n[1];n=ledgerValidationModule.indicate(t,e,'"Destination"',"b");t=n[0];e=n[1];n=ledgerValidationModule.indicate(t,e,'"issuer"',"b");t=n[0];e=n[1];n=ledgerValidationModule.indicate(t,e,'"currency"',"y");t=n[0];e=n[1];n=ledgerValidationModule.indicate(t,e,'"value"',"y");t=n[0];e=n[1];n=ledgerValidationModule.indicate(t,e,'"TransactionType"',"y");t=n[0];e=n[1];n=ledgerValidationModule.indicate(t,e,'"Amount"',"y");t=n[0];e=n[1];t++}return e};ledgerValidationModule.rowHeight=function(e){var t=$("#container").width(),n=Math.ceil(e.length/(t/10)),r=ledgerValidationModule.LINE_HEIGHT*n-3;return r};ledgerValidationModule.waiting=!1;ledgerValidationModule.pendingTransactions=0;ledgerValidationModule.interval=setInterval(function(){if(!ledgerValidationModule.waiting&&ledgerValidationModule.lastDisplayedLedgerIndex)if(ledgerValidationModule.eventQueue[ledgerValidationModule.lastDisplayedLedgerIndex])if(ledgerValidationModule.eventQueue[ledgerValidationModule.lastDisplayedLedgerIndex].length>0){var e=ledgerValidationModule.eventQueue[ledgerValidationModule.lastDisplayedLedgerIndex].pop();if(e.type==="ledgerClosed"){$("#eventsTable").prepend("<div class='ledger trow'></div>");var t=$("#eventsTable").find("div").first(),n=JSON.stringify(e),r=ledgerValidationModule.rowHeight(n);t.text(n);setTimeout(function(){$("#ledgerstate").text("CLOSED");t.css("height",r+"px");$("#header").css("color","lime").css("font-weight","bold");$("#ledgernumber").text(e.ledger_index)},10);setTimeout(function(){$("#eventsTable").find("div.transaction").css("height","19px")},500)}else if(e.type==="transaction"){$("#eventsTable").prepend("<div class='transaction trow'></div>");var t=$("#eventsTable").find("div").first(),n=JSON.stringify(e.transaction),r=ledgerValidationModule.rowHeight(n);t.html(ledgerValidationModule.addSpecialColors(n));ledgerValidationModule.pendingTransactions++;$("#pendingtransactions").text(ledgerValidationModule.pendingTransactions);setTimeout(function(){t.css("height",r+"px")},10)}}else{delete ledgerValidationModule.eventQueue[ledgerValidationModule.lastDisplayedLedgerIndex];ledgerValidationModule.waiting=!0;setTimeout(function(){$("#eventsTable").find("div").remove();ledgerValidationModule.pendingTransactions=0;$("#pendingtransactions").text(ledgerValidationModule.pendingTransactions);$("#ledgerstate").text("OPEN");$("#header").css("color","lightgray").css("font-weight","normal");ledgerValidationModule.lastDisplayedLedgerIndex+=1;ledgerValidationModule.waiting=!1},1500)}else ledgerValidationModule.eventQueue[ledgerValidationModule.lastDisplayedLedgerIndex+1]&&(ledgerValidationModule.lastDisplayedLedgerIndex+=1)},2e3);$("#explanation").tooltip({title:"This feed shows the live stream of transactions being received by a Ripple server. When the network has come to consensus on the set of valid transactions, the ledger is closed.",placement:"auto left"});