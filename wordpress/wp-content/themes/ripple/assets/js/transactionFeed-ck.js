// tfm is short for transactionFeedModule
// note the last line: var transactionFeedModule = tfm;
var tfm={};tfm.tx_stack=[];tfm.loadHistoricalData=function(e){tfm.tx_stack=e.recent_payments_and_offercreates.concat(tfm.tx_stack);tfm.startInterval()};tfm.handleNewEvent=function(e){if(e.type==="transaction"){var t=e.transaction;(t.TransactionType==="Payment"||t.TransactionType==="OfferCreate")&&tfm.tx_stack.push(t)}};tfm.startInterval=function(){tfm.intervalFunction();setInterval(tfm.intervalFunction,3e3)};tfm.intervalFunction=function(){if(tfm.tx_stack.length>0){var e=tfm.tx_stack.pop(),t=tfm.txToHTML(e);t!==""&&$("#transactionFeed").html(t)}};tfm.txToHTML=function(e){var t=e.TransactionType,n,r;if(t==="Payment"){n=tfm.standardizeAmount(e.Amount);r=null}else if(t==="OfferCreate"){n=tfm.standardizeAmount(e.TakerGets);r=tfm.standardizeAmount(e.TakerPays)}var i="";t==="Payment"?i+='<i class="icon-mail-forward"></i>':t==="OfferCreate"&&(i+='<i class="icon-tags"></i>');i+=tfm.renderAmount(n);if(t==="Payment")i+='<span class="small"><em>payment delivered</em></span>';else if(t==="OfferCreate"){i+='<span class="small"><em>offered for</em></span>&nbsp;';i+="<strong>"+r.numStr+"</strong>"+"&nbsp;"+r.currency+"&nbsp;"}return i};tfm.standardizeAmount=function(e){if(e.currency===undefined||e.currency===null){var t=e;e={};e.currency="XRP";e.value=t/1e6}var n="";if(e.value<.01)n="<0.01";else if(e.value>=5e11){e.value=Math.round(e.value/1e12*100)/100;n=e.value+" T"}else if(e.value>=5e8){e.value=Math.round(e.value/1e9*100)/100;n=e.value+" B"}else if(e.value>=5e5){e.value=Math.round(e.value/1e6*100)/100;n=e.value+" M"}else{e.value=Math.round(e.value*100)/100;var r=e.value.toString().split(".");r[0]=r[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");n=r.join(".")}e.numStr=n;return e};tfm.renderAmount=function(e){var t="";t+="<strong>"+e.numStr+"</strong>"+"&nbsp;";t+=e.currency+"&nbsp;";return t};var transactionFeedModule=tfm;